---
title: |
  Only You:
  A Field Experiment of Text Message to Prevent Free-riding in Japan Marrow Donor Program
author:
  - Hiroki Kato (Hitostubashi Institute for Advanced Study, Hitotsubashi University, Tokyo, Japan)
  - Fumio Ohtake (Center for Infectious Disease Education and Research (CiDER), Osaka University, Osaka, Japan)
  - Saiko Kurosawa (Department of Oncology, Ina Central Hospital, Nagano, Japan)
  - Kazuhiro Yoshiuchi (Graduate School of Medicine, Tokyo University, Tokyo, Japan)
  - Takahiro Fukuda (Department of Hematopoietic Stem Cell Transplantation, National Cancer Center Hospital, Tokyo, Japan)
date: "Last updated on `r format(Sys.Date(), '%B %d, %Y')`"
bibliography: biblio.bib
output:
  bookdown::word_document2:
    numnber-sections: true
    toc: false
---

```{r include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  warning = FALSE,
  error = FALSE,
  message = FALSE,
  dev = "ragg_png"
)
```

# Introduction {#intro}

同種造血幹細胞移植は白血病などの血液病に対する最も再発率の低い治療法の一つである。この治療法では、(1)抗がん剤や放射線によって異常な細胞と健康な造血幹細胞を同時に殺し、(2)他者から提供された健康な造血幹細胞を移植する。骨髄移植（造血幹細胞移植）における要件は、ドナーのHLAと呼ばれる白血球の型が患者のHLAと一致していることである[^hapro]。ランダムに選ばれた二人のマッチング確率は1%未満である一方で、兄弟姉妹間で一致する可能性が最も高く、その確率は30%程度である。また、親子間のマッチング確率はかなり低い。親族の中に適合するドナーがいなければ、患者は近親者以外からドナーを探さなければならない。日本において、患者は一般的に日本骨髄バンク（JMDP）を介して非近親者のドナーを探すことになる。しかしながら、JMDPによるコーディネーションは移植に至るまで長時間を要し、登録患者の60%のみが移植を受けられない [@Hirakawa2018]。

[^hapro]: 近年、ハプロ移植と呼ばれる、半合致したHLAを持つ近親者間での移植が広がりつつある。加えて、母子をつなぐさい帯や胎盤に含まれる血液細胞の移植（さい帯血移植）も同様に人気になっている。骨髄移植と異なり、HLAが完全に合致していなくても、さい帯血移植は実施できる。

患者の生存確率を高めるためのドナープールに対する介入は二種類ある。第一に、潜在的なドナーの人数を増やして、マッチング確率を高めるような政策である。4人未満のドナーと合致する患者と比較して、200人以上のドナーと合致する患者の移植率は45%から74%に上昇する [@Hirakawa2018]。しかしながら、2000年から2015年にかけて潜在的なドナーの数は約二倍に増えたにもかかわらず、初回マッチング確率は5%程度しか増えていない [@Takanashi2016] [^reason]。したがって、潜在的なドナーを増やすことの限界便益は小さいので、プールの規模を拡大することは非効率的であるだろう。

[^reason]: これは珍しいHLAの型を持つ新しいドナーの確率が低いからである。

第二の政策はドナープールに提供を断らない潜在的なドナーの比率を高めることである。この種の政策はドナープールの質に貢献するものである。@Hirakawa2018 は多くの移植コーディネーションはドナー側の都合により、コーディネーションの第一過程である確認検査の前に中断していることを示している（コーディネーションの過程は第 \@ref(background) 節を参照）。したがって、提供の意思の強い多くの潜在ドナーでできたプールを作ることは移植率を高めるだろう。また、ドナープールの質を改善する政策の限界便益はドナープールの規模を拡大する政策のそれよりも高いだろう。

そこで、本研究はドナープールの質を改善する政策の一つとして情報提供の効果を検証する。JMDPに登録した人がある患者の潜在的なドナーとなると、潜在ドナーはJMDPから適合通知を受け取る。そして、提供意思を示して適合通知に返信する潜在ドナーは移植のためのコーディネーションを受ける。我々はJMDPによって公開されている情報に基づいて適合通知に新規のメッセージを加えて、追加メッセージの効果を検証するフィールド実験を2021年9月から2022年2月にかけて実施した。介入メッセージは二つある。第一に、患者一人あたりの潜在的なドナーの数が少ないという情報（確率情報）である。患者一人につき複数の潜在的なドナーが同時にコーディネーションを受けるので、JMDPを通じた幹細胞移植は公共財の性質を持つ。したがって、同時にコーディネーションを受けている潜在的なドナーが多ければ多いほど、フリーライドするインセンティブが強くなる。第一のメッセージはコーディネーション進行中のドナーの数に関する過剰な期待によって生じるただ乗り行動を妨げることを目的としている。もう一つのメッセージはJMDPに登録した患者の半分しか移植を受けられないというもの（利他情報）である。この情報は幹細胞提供という利他行動の価値を高めることを目的としている。また、このメッセージは候補となるドナーが早く見つけられるほど、移植率を高められることも明記して、適合通知に早く返信してもらうことを目的としている。

我々はJMDPに実験機関に適合通知を受け取った人に関するコーディネーション過程のデータの提供を依頼し、情報を提供することの効果を分析した。我々のフィールド実験は情報提供の効果は異質的であることを示している。確率情報は移植成績がよいにもかかわらず適合通知への返信率が低い若年層の男性に効果的であるが、利他情報は若年男性に効果的でなかった。さらに、二つの情報を同時に提供する介入も、利他情報に強く影響を受けてしまうために、効果的でなかった。

# Field Experiment {#experiment}

```{r library, include=FALSE}
library(here)
library(tidyverse)
library(lubridate)
library(estimatr)
library(fixest)
library(grf)
library(modelsummary)
library(kableExtra)
library(flextable)
library(officer)
library(RCTtoolbox)
library(patchwork)
lapply(list.files(here("R/func"), "r", full.names = TRUE), source)

options(
  knitr.table.format = "markdown",
  kableExtra.auto_format = FALSE,
  modelsummary_stars_note = FALSE,
  modelsummary_factory_default = "flextable",
  modelsummary_factory_html = "kableExtra",
  modelsummary_factory_latex = "kableExtra",
  modelsummary_factory_word = "flextable"
)

tidy_custom.lm_robust <- function(x, ...) broom::tidy(x)
```

## Background: Coordination Process of JMDP {#background}

フィールド実験の介入のタイミングの理解を促すために、JMDPに登録した潜在ドナーによる幹細胞の提供までのコーディネーション過程を概観しておく。はじめに、潜在ドナーがJMDPに登録した患者とマッチすると、JMDP事務局は潜在ドナーに幹細胞提供を依頼する適合通知（compatibility notice）を送付する[^SNS]。潜在ドナーは問診票を記入し、提供意思の有無を示して、適合通知に返信する。

[^SNS]: JMDPは同時に潜在ドナーにJMDPが適合通知を送付したことを知らせるSNSメッセージを送付する。

その後、移植に向けたコーディネーションが始まる。潜在ドナーはおよそ1カ月以内に確認検査（confirmatory typing）を受ける。この段階では、コーディネーターは提供手順の詳細（骨髄採取もしくは末梢血幹細胞採取）を説明し、潜在ドナーとその家族に提供の意向を調査する。潜在ドナーは二つの採取方法を選べる。加えて、コーディネーター医師が問診、検診、感染症の有無と血液型を調べる採血をする。これらのテストは潜在ドナーがJMDPの定める基準に満たしているかどうかを検査する。

患者は同時に最大10人の潜在ドナーとのコーディネーションを受けられる。患者の医師は確認検査を受けた潜在ドナーから最も適切な候補者を選ぶ。重要なこととして、潜在ドナーはマッチしている患者の情報（他の潜在ドナーと何人マッチしているかなど）を一切知ることができない。また、潜在ドナーがコーディネーターやコーディネーター医師からそのような情報を得ることもできない。

最も適切な候補者として選ばれた潜在ドナーはコーディネーターやコーディネーター医師からの説明を受けた後に、最終同意をする必要がある。同時に、ドナーの家族の代表者も採取に同意しなければならない。ただし、これ以降、潜在ドナーは意向を変えられない。最終同意後、潜在ドナーは術前検査や採取の準備を受けるために1週間程度の入院をする。この後、ドナーは幹細胞採取の手術を受ける。確認検査から採取までの時間はおよそ3--4カ月である。

## Experimental Design {#design}

```{r message, fig.cap="Intervention Messages"}
knitr::include_graphics("image/intervention.png")
```

我々の実験はJMDPが潜在ドナーに幹細胞提供を依頼する適合通知の内容に介入を施す。図 \@ref(fig:message) は我々の介入を示す。適合通知は提供ドナーが7日以内に返信するべきことを注記している。また、JMDPは適合通知と一緒に前小節で概観したコーディネーション過程を記述したハンドブックを同封している。

我々はコーディネーションを促進するために適合通知に二つのメッセージを加えた[^pressure]。確率メッセージはJMDPに登録した患者あたりの潜在ドナーの数が少ないことを強調している。一人以上の潜在ドナーが一人の患者とマッチするので、幹細胞提供は公共財の性質を有している。標準的な経済学理論は潜在ドナーがただ乗りするインセンティブを持っており、提供のやる気を削いでしまうことを提示している。また、貢献者の数が多いほど、ただ乗りするインセンティブは強くなるはずである。これまでの実証研究はこの仮説に対して混在したエビデンスを示している<!--//TODO: エビデンスの追加--->。我々は潜在ドナーが他の潜在ドナーの数について過度に多く見積もっており、標準的な経済学理論に従ったただ乗り行動を取っていると考えた。よって、確率メッセージは他の潜在ドナーの数の信念を下方修正することを通じて、提供意向を高めることを目的としている。

[^pressure]: 介入メッセージを作成したとき、我々は潜在ドナーに対して過度な心理的プレッシャーを与えないように配慮している。具体的には、第一に、嘆願調のような表現を避けている。第二に、JMDPが公開している情報のみを用いている。また、移植リスクは通常通り説明している。

第二のメッセージはEarly Coordinationメッセージである。このメッセージは登録患者の半数程度しか移植を受けられないことを強調して、潜在ドナーの利他性を刺激している。さらに、このメッセージは適切な潜在ドナーが早く見つかるほど、患者の生存率が高くなることを伝えている。<!--//TODO: 簡単に仮説を明記する-->

我々は二つの介入メッセージの効果を推定するために四つの実験群を設けた。実験群Aは介入メッセージなしの標準的な適合通知を送付した（コントロール群）。実験群BとCはそれぞれ確率メッセージとEarly Coordinationメッセージを追加した適合通知を送付した。実験群Dは二つの介入メッセージを同時に加えた適合通知を送付した。この実験群は情報過多による認知負荷の負の影響を検証する目的で設けた。

```{r schedule-data, include=FALSE}
root <- "D:/JMDPフィールド実験"

schedule <- read_csv(here(root, "RCT-schedule.csv")) %>%
  mutate(
    my = paste0(month, "/", year - 2000),
    my = factor(
      my,
      levels = c("9/21", "10/21", "11/21", "12/21", "1/22", "2/22"),
      labels = c("Sep 21", "Oct 21", "Nov 21", "Dec 21", "Jan 22", "Feb 22")
    ),
    week = factor(week, levels = 1:4, labels = paste("Week", 1:4))
  ) %>%
  dplyr::select(week, my, treat) %>%
  pivot_wider(values_from = treat, names_from = my)
```

```{r assignment, tab.cap = "Assignment Schedule"}
flextable(schedule) %>%
  align(j = -1, align = "center", part = "all") %>%
  padding(j=1:7, padding.top = 5, padding.bottom = 5, part="all") %>%
  fontsize(size = 9, part = "all")  %>%
  ft_theme()
```

実験参加者は2021年9月から2022年2月の間に適合通知を受け取った11,154名の潜在ドナーである。JMDP事務局に無理のない範囲でランダムネスを保つために、我々は実験群を週単位のクラスターランダム化で割り当てた。このとき、可能な限り週と月で実験群がバランスするように設計している。表 \@ref(tab:assignment) に割り当てスケジュールをまとめている。

## Data and Empirical Strategy

我々はJMDPの協力のもと、コーディネーションデータを2022年6月末に受け取った。観測単位は実験参加者である。個人属性として、データは性別・年齢・コーディネーション経験回数・都道府県レベルの在住地区を記録している。コーディネーション過程として、データは各段階（適合通知への返信・確認検査・候補者選定・最終同意・採取）に到達したかどうかを記録している。我々はこれらの変数をアウトカム変数として用いる。特に、適合通知への返信について、データは返信日数と提供意向を追加的に記録している。コーディネーションが中断したならば、データは中断理由を三つのカテゴリ（患者側の理由・健康以外のドナー理由・ドナーの健康理由）で記録している。分析では、日本在住かつコーディネーションが（中断を含めて）終了している11,049名の潜在ドナーを用いる[^exclude]。

[^exclude]: 一人が海外に在住していた。また、データ提供時点でコーディネーションが進行中であった潜在ドナーは104名いた。コーディネーションが進行中の潜在ドナーの比率は実験群間でバランスしている（F-value, p-value=$0.964$）。

追加的なデータとして、我々はJMDPがウェブ上で公開している医療機関リストを用いる。このリストは完全な住所・骨髄採取（BM collection）が可能かどうか・末梢血幹細胞採取（PBSC collection）が可能かどうかを含んでいる。我々はこのリストを都道府県レベルで集約し、10平方キロメートルあたりの病院数を計算し、それをコーディネーションデータと都道府県をマージキーにして突合した。我々はこの変数をコーディネーションや提供のトラベルコストとして考慮する。

表 <!--//TODO table label--> はフィールド実験の概要である。パネルAは各実験群の介入を示しており、パネルBは各実験群のサンプルサイズを示している。パネルCはランダム化が成功しているかどうかを検証するバランステストである。多くの変数が実験群間で平均的にバランスしているので、実験群の割り当てはおおよそランダムである。<!-- //TODO 年齢違いを入れるか -->

我々の関心のあるパラメータは母集団全体の平均処置効果であり、実験群間の平均値の差で識別できる。それに加えて、我々は月・週固定効果を取り除き、共変量を加えることで推論の確度を高めるために、線形確率モデルを推定する。$m$月の$w$週に適合通知を受け取った個人$i$についての推定モデルは以下の通りである。

$$
  Y_{imw} =
  \beta_1 \cdot \text{B}_{mw} + \beta_2 \cdot \text{C}_{mw}
  + \beta_3 \cdot \text{D}_{mw}
  + X'_i \gamma + \lambda_m + \theta_w + u_{imw},
$$

ここで$X_i$は個人属性ベクトル、$\lambda_m$と$\theta_w$はそれぞれ月および週のダミー変数である。<!--//TODO クラスター標準誤差を用いるならばその論拠をここに書く --->

